repos:
  # General checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: check-yaml
        args: ['--unsafe']  # Allow custom YAML tags
        exclude: 'snippets/.*\.yaml$'  # Exclude Helm templates
      - id: check-json
      - id: check-added-large-files
        args: ['--maxkb=500']
      - id: detect-private-key
      - id: end-of-file-fixer
      - id: trailing-whitespace
        args: [--markdown-linebreak-ext=md]

  # Python linting (for hook scripts)
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.8.6
    hooks:
      - id: ruff
        args: [--fix]
      - id: ruff-format

  # Shell script linting
  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: v0.10.0.1
    hooks:
      - id: shellcheck
        args: ['-x']  # Follow source statements

  # Secrets detection
  - repo: https://github.com/gitleaks/gitleaks
    rev: v8.21.2
    hooks:
      - id: gitleaks

  # Conventional commits
  - repo: https://github.com/compilerla/conventional-pre-commit
    rev: v3.6.0
    hooks:
      - id: conventional-pre-commit
        stages: [commit-msg]
        args: ['--strict']

  # YAML linting
  - repo: https://github.com/adrienverge/yamllint
    rev: v1.35.1
    hooks:
      - id: yamllint
        args: [-c, .yamllint.yaml]
        exclude: 'snippets/.*\.yaml$'  # Exclude template snippets

  # Claude Code hooks.json schema validation
  - repo: https://github.com/python-jsonschema/check-jsonschema
    rev: 0.30.0
    hooks:
      - id: check-jsonschema
        name: Validate hooks.json schema
        files: 'hooks\.json$'
        args: ['--schemafile', 'schemas/hooks.schema.json']

  # Skill YAML frontmatter validation
  - repo: local
    hooks:
      - id: validate-skills
        name: Validate SKILL.md frontmatter
        entry: python3 scripts/validate-skills.py
        language: system
        files: 'SKILL\.md$'
        pass_filenames: true
