# infra/{env}/cluster/controllers/{component}/kustomization.yaml
# Controller overlay - references base and adds ConfigMapGenerator for values
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: flux-system

resources:
  - ../../../../base/cluster/controllers/cert-manager

generatorOptions:
  disableNameSuffixHash: true       # CRITICAL: prevents name suffix changes

configMapGenerator:
  - name: cert-manager-values
    files:
      - values.yaml                 # Environment-specific values
---
# infra/{env}/cluster/controllers/{component}/values.yaml
# CRITICAL: Disable CRD installation - managed separately in infra/crds/
installCRDs: false

fullnameOverride: cert-manager

serviceAccount:
  create: true
  name: cert-manager

global:
  leaderElection:
    namespace: cert-manager

resources:
  requests:
    cpu: 10m
    memory: 64Mi
  limits:
    memory: 256Mi
